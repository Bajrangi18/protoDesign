<html><head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <title>Title of the document</title>
    </head>
    <body><br>
    
    <center>
      <div class="container">
          <div class="row" id="top_row">
             <div class="col" id="date">
                 <p>31st MAR 2022</p>
            </div>
            <div class="col-6" id="mainCol">
              <p id="time">09:30 PM</p>
            </div>
            <div class="col" id="batt">
                <div class="container" id="battery">
                    <p id="batt_lev">99%</p>
                </div>
            </div>
      </div>
      <div class="container">
          <div class="row" id="center_row">
             <div class="col"></div>
            <div class="col-6" id="mainCol">
              <p id="speed">99</p>

            </div>
            <div class="col"><p id="kmph">kmph</p></div>
          </div>
      </div>
    </div>
    <div class="container" id="bpmRow">
          <div class="row" id="end_row">
             <div class="col-4" id="heart">
                 <img src="hr-removebg-preview.png" alt="" id="heart_logo">
            </div>
            <div class="col-3" id="dataBody">
              <p id="bpm_data">180</p>
            </div>
            <div class="col-4">
                <p id="bpm_si">BPM</p>
            </div>
      </div>
    </div>
          <div class="container" id="spRow">
          <div class="row justify-content-md-center" id="end_row2">
             <div class="col-4" id="date">
                 <img src="327-3271562_oxygen-tank-icon-oxygen-icon-png-removebg-preview.png" alt="" id="sp02_logo">
            </div>
            <div class="col-3" id="mainCol">
              <p id="sp02_data">100</p>
            </div>
            <div class="col-4" id="batt">
                <p id="sp02_si">%</p>
            </div>
      </div>
    </div>
        <div class="container" id="btn_id">
              <button type="button" class="btn btn-outline-dark btn-lg" id="btn">CONNECT</button>
          </div>   
    </center>
<!-- <div class="container" id="left_Border">
</div>
<div class="container" id="right_Border">
</div>    
<div class="container" id="bot_Border">
</div>   -->
<!--   <script src="app.js" charset="utf-8"></script> -->
        <script>
            var myCharacteristic;
    const btn = document.getElementById("btn");
    const text1 = document.getElementById("batt_lev");
    const text2 = document.getElementById("speed");
    const text3 = document.getElementById("bpm_data");
    const text4 = document.getElementById("sp02_data");
    const bot_B = document.getElementById("bot_Border");

  btn.addEventListener("click", async event =>{
        startButton();
   })

  function handleNotifications(event) {
  let value = event.target.value;
  let a = [];
  for (let i = 0; i < value.byteLength; i++) {
    a.push(value.getUint8(i));
  }
     log1(a[0]);
     log2(a[1]);
     log3(a[2]);
     if(Boolean(a[4]){
        bot_B.style.opacity = "1";
        }else{
         bot_B.style.opacity = "0";
     }
     
 }



function log1(data) {
  text1.innerHTML = data + "%"; 
}
function log2(data) {
  text2.innerHTML = data; 
}
function log3(data) {
  text3.innerHTML = data; 
}
function log4(data) {
  text4.innerHTML = data; 
}


function startButton() {
  navigator.bluetooth.requestDevice({
     acceptAllDevices: true,
     optionalServices: ['4fafc201-1fb5-459e-8fcc-c5c9c331914b']
  })
  .then(device => {
//       log('Connecting to GATT Server...' + device.name );
    return device.gatt.connect();
  })
  .then(server => {
//       log('Getting Service...');
   return server.getPrimaryService("4fafc201-1fb5-459e-8fcc-c5c9c331914b");
  })
  .then(service => {
//       log('Getting Characteristic...');
      return service.getCharacteristic("beb5483e-36e1-4688-b7f5-ea07361b26a8");
  })
  .then(characteristic => {
   myCharacteristic = characteristic;
    return myCharacteristic.startNotifications().then(_ => {
    // log('> Notifications started');
    myCharacteristic.addEventListener('characteristicvaluechanged',
    handleNotifications);
    });
  })
  .catch(error => {
     log(error);
  });
}
        </script>


</body></html>
